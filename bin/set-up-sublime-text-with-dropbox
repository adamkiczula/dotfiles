#!/usr/bin/env bash
# Set up Sublime Text 2 to sync packages and settings through Dropbox.

SUBL_SRC="$DROPBOX_PATH/Library/Application Support/Sublime Text 2"
SUBL_DEST="$HOME/Library/Application Support/Sublime Text 2"

SUBL_INSTALLED="Installed Packages"
SUBL_PACKAGES="Packages"
SUBL_PRISTINE="Pristine Packages"

SUBL_DATE="$(date '+%Y%m%d')"

mv -v "${SUBL_DEST}/${SUBL_INSTALLED}" "${SUBL_DEST}/${SUBL_INSTALLED}-${SUBL_DATE}"
mv -v "${SUBL_DEST}/${SUBL_PACKAGES}" "${SUBL_DEST}/${SUBL_PACKAGES}-${SUBL_DATE}"
mv -v "${SUBL_DEST}/${SUBL_PRISTINE}" "${SUBL_DEST}/${SUBL_PRISTINE}-${SUBL_DATE}"

ln -sv "${SUBL_SRC}/${SUBL_INSTALLED}" "${SUBL_DEST}/${SUBL_INSTALLED}"
ln -sv "${SUBL_SRC}/${SUBL_PACKAGES}" "${SUBL_DEST}/${SUBL_PACKAGES}"
ln -sv "${SUBL_SRC}/${SUBL_PRISTINE}" "${SUBL_DEST}/${SUBL_PRISTINE}"

echo <<EOS
You should start Sublime Text 2. If everything is working as intended, you may remove the original
Installed Packages, Packages and Pristine Packages folders in ${SUBL_DEST}.
EOS
